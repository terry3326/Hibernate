Hibernate的一級緩存
※什麼是緩存
1.數據存到數據庫裡面,數據庫本身是文件系統,使用流方式操作文件效率不是很高.
(1)把數據存到內存裡面,不需要使用流方式,可以直接讀取內存中數據
(2)把數據放到內存中,提供讀取效率

※Hibernate緩存
1. Hibernate 框架中提供很多優化方式,Hibernate的緩存就是一個優化方式

2.Hibernate緩存特點:
第一類Hibernate的一級緩存
(1)Hibernate的一級緩存默認打開的
(2)Hibernate的一級緩存使用範圍,是session範圍,從sessiont創建到session關閉範圍
(3)Hibernate的一級緩存中,存儲數據必須 " 持久態 " 數據

第二類Hibernate的二級緩存
(1)目前已經不使用,替代技術redis
(2)二級緩存默認不是打開的,需要配置
(3)二級緩存使用範圍,是sessionFactory範圍

表與表之間關係的回顧
1.一對多:
    (1)分類與商品關係,一個分類裡面有多個商品,一個商品只能屬於一個分類
    (2)客戶和聯繫人是一對多關係
    客戶:與公司有業務往來:百度、新浪...
    聯繫人:公司裡面的員工,百度裡面有很多員工,聯繫員工
    **公司與公司員工的關係
    客戶是一,聯繫人是多
    一個客戶裡面有多個聯繫人,一個聯繫人只能屬於一個客戶
    (3)一對多建表:通過外鍵建立關係

2.多對多:
    (1)訂單與商品關係,一個訂單裡面有多個商品,一個商品屬於多個訂單

    (2)用戶和角色多對多關係
    -用戶: 小王、小馬、小宋
    -角色: 總經理、秘書、司機、保安
    **比如說小王 可以是 總經理 司機
    **比如說小宋 可以是 司機 秘書 保安
    **比如說小馬 可以是 秘書 總經理
    一個用戶裡面可以有多個角色,一個角色裡面可以有多個用戶

    (3)多對多建表:創建第三張表維護

3.一對一
(1)在中國,一個男人只能有一個妻子,一個女人只能有一個丈夫


Hibernate的一對多操作(重點)
※一對多映射配置
第一步 創建兩個實體類,客戶和聯繫人
第二步 讓兩個實體類之間互相表示
(1) 在客戶實體類裡面表示多個聯繫人 : 一個客戶裡面有多個聯繫人
(2) 在聯繫人實體類裡面表示所屬客戶 : 一個聯繫人只能屬於一個客戶
第三步 配置映射關係
(1) 一般一個實體類對應一個映射文件
(2) 把映射最基本配置完成

(3) 在映射文件中,配置一對多關係 (重點)
 - 在客戶映射文件中,表示所有聯繫人
 - 在聯繫人映射文件,表示所屬客戶
第四步 創建核心配置文件,把映射文件引入到核心配置文件中

※一對多級聯操作
    一.級聯操作
    (1)添加一個客戶,為這個客戶添加多個聯繫人
    二.級聯刪除
    (1)刪除某一個客戶,這個客戶裡面的所有聯繫人也刪除

    ※一對多級聯保存-簡化寫法(重點)
    -一般根據客戶添加聯繫人
    第一步 在客戶映射文件中進行配置
    - 在客戶映射文件裡面set標籤進行配置:cascade="save-update"
    第二步 創建客戶和聯繫人對象,只需要把聯繫人放到客戶裡面就可以了,最終只需要保存客戶就可以了

    ※一對多級聯刪除重點)
    1. 刪除某個客戶, 把客戶裡面所有聯繫人刪除
    2. 具體實現
    第一步 在客戶映射文件set標籤,進行配置
        (1) 使用屬性 cascade 屬性值 delete
    第二步 在代碼中直接刪除客戶
        (1)根據id查詢對象,調用session裡面delete方法刪除
    3.執行過程
    (1)根據id查詢客戶
    (2)根據外鍵id值查詢聯繫人

    ※一對多修改操作
    1. 讓聯繫人lucy所屬的客戶不是傳智播客,而是百度
    2. inverse 屬性
        (1)因為hibernate雙向維護外鍵,在客戶和聯繫人裡面都需要維護外鍵,修改客戶時候修改一次外鍵,
           修改聯繫人時候也修改一次外鍵,造成效率問題
        (2)解決方式:讓其中的一方不維護外鍵
            一對多裡面,讓一的這方放棄外鍵維護
            一個國家有總統,國家有很多人,總統不能認識國家所有人,國家所有人可以認識總統
        (3)具體實現:
            在放棄關係維護映射文件中,進行配置,在set標籤上使用inverse屬性






